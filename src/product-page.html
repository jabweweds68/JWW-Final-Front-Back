<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Our Products</title>

  <link rel="icon" type="image/png" href="./assets/images/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="./assets/images/favicon.svg" />
  <link rel="shortcut icon" href="./assets/images/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/images/apple-touch-icon.png" />
  <link rel="manifest" href="./assets/images/site.webmanifest" />


  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Mallanna&family=Raleway:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/@splidejs/splide-extension-auto-scroll@0.5.3/dist/js/splide-extension-auto-scroll.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css" rel="stylesheet" />
<!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '793268460233772');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=793268460233772&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->


</head>

<body>
  <div class="whatsapp-direct-chat">

    <a href="https://wa.me/9203390117465">
      <img src="./assets/images/Frame 166.svg" alt="">
    </a></li>
</div>
  <div class="cart-btn-float" id="open-cart">
    <div class="number-in-cart">0</div>
    <img src="./assets/images/cart.svg" alt="">
  </div>
  <!-- My Cart -->
  <div class="cart-section-side" id="cart">
    <div class="close-btn-cart" id="close-cart">Close</div>
    <div class="heading-empty" id="empty-cart-message">
      <h1>Empty Cart Shop Now</h1>
    </div>
    <div class="cart-products-card" id="cart-products-container">
      <div class="products-wrapper">
        <!-- Cart items will be dynamically added here -->
      </div>

      <div class="shop-more">
        SHOP MORE
        <img src="./assets/images/shop more.svg" alt="">
      </div>
    </div>

    <div class="sub-totals-product" id="cart-totals">
      <div class="products-total-p">
        <span>Products : </span>
        <span id="products-total">0</span>
      </div>
      <div class="delivery-charges">
        <span>Delivery Charges</span>
        <span>250</span>
      </div>
      <div class="subtotal">
        <span>Subtotal</span>
        <span id="subtotal">250</span>
      </div>
      <div class="cta-check">
        <div class="cta checkout" id="Navigate-to-checkout">CHECK OUT</div>
        <div class="del" id="clear-cart"><img src="./assets/images/del.svg" alt=""></div>
      </div>
    </div>
  </div>

  <div class="slide-bar">
    <div class="menu-2">
      <a href="./index.html">HOME</a>
      <a href="./About.html">About</a>
      <a href="./contact.html">CONTACT</a>
    </div>
    <div class="close-btn">CLOSE</div>
    <div class="upper-picture-menu">
      <div class="grid-box-container">
        <div class="box" id="product-page">
          <div class="elents"><img src="./assets/images/el-1.png" alt=""></div>
          <div class="elents"><img src="./assets/images/marq-2.png" alt=""></div>
          <div class="elents"><img src="./assets/images/el-2.png" alt=""></div>
          <div class="name-box">DARK DESIRE</div>
          <div class="choco-menu"><img src="./assets/images/Dark Desire Regular.png" alt=""></div>
        </div>
        <div class="box" id="product-page">
          <div class="elents"><img src="./assets/images/el-1.png" alt=""></div>
          <div class="elents"><img src="./assets/images/marq-2.png" alt=""></div>
          <div class="elents"><img src="./assets/images/el-2.png" alt=""></div>
          <div class="name-box">STRAWBAE</div>
          <div class="choco-menu"><img src="./assets/images/Strawbae Regular.png" alt=""></div>
        </div>
        <div class="box" id="product-page">
          <div class="elents"><img src="./assets/images/el-3.png" alt=""></div>
          <div class="elents"><img src="./assets/images/marq-1.png" alt=""></div>
          <div class="elents"><img src="./assets/images/el-2.png" alt=""></div>
          <div class="name-box">VANILLALUST</div>
          <div class="choco-menu"><img src="./assets/images/Vanillust Regular.png" alt=""></div>
        </div>
        <div class="box" id="product-page">
          <div class="elents"><img src="./assets/images/el-3.png" alt=""></div>
          <div class="elents"><img src="./assets/images/marq-1.png" alt=""></div>
          <div class="elents"><img src="./assets/images/el-2.png" alt=""></div>
          <div class="name-box">BUNDLE</div>
          <div class="choco-menu bundle-c"><img src="./assets/images/bundle.png" alt=""></div>
        </div>
      </div>
    </div>
  </div>

  <nav>
    <div class="since">since 2025</div>
    <div class="line-bar"></div>
    <div class="logo">
      <img src="./assets/images/spl-removebg-preview 1.png" alt="">
    </div>
    <div class="line-bar"></div>
    <div class="menu">MENU</div>
  </nav>

  <div class="product-page-hero">
    <div class="left-side-product-picture">
      <div class="upper-picture-p" id="slider-product-ch">
        <!-- Product images will be dynamically loaded -->
      </div>
      <div class="btns-next-prev-setion">
        <div class="btns-next-p-1"><img src="./assets/images/left.png" alt=""></div>
        <div class="btns-next-p-1"><img src="./assets/images/right.png" alt=""></div>
      </div>
      <div class="middle-picture-p">
        <div class="img-p-1">
          <img src="./assets/images/ABout-pic.png" alt="">
        </div>
        <div class="img-p-1">
          <img src="./assets/images/ABout-pic.png" alt="">
        </div>
      </div>
      <div class="upper-picture-p last-p">
        <img src="./assets/images/ABout-pic.png" alt="">
      </div>
    </div>
    <div class="right-side-content-product">
      <div class="heading-product-p">
        <h1 id="product-name">Loading...</h1>
      </div>
      <div class="product-para" id="product-description">Loading product description...</div>

      <h2 class="heading-product-c">Categories</h2>
      <div class="slider-btn-section product-btn-size" id="category-buttons">
        <!-- Category buttons will be dynamically loaded -->
      </div>

      <h2 class="heading-product-c">Sizes</h2>
      <div class="sizes-btn" id="size-buttons">
        <!-- Size buttons will be dynamically loaded -->
      </div>

      <div class="boxes-price-select" id="box-selection">
        <!-- Box selection will be dynamically loaded -->
      </div>
      <div class="price-line">
        <div class="total" id="total-price">PKR: 0</div>
        <div class="total-name" id="total-description">Select options</div>
      </div>

      <div class="btn-p-cart">
        <div class="cta" id="add-to-cart">ADD TO CART</div>
      
      </div>
      <div class="faqs-product">
        <div class="faq-product-1">
          <div class="heading-faqs-product">
            <h1>What special ingredients are in your chocolates?</h1>
            <div class="icon-flip"><img src="./assets/images/x-vector.svg" alt=""></div>
          </div>
          <p id="para-faq-p">We use natural ingredients known to help with romance and vitality. Our chocolates contain
            things like Black Maca Root and Ashwagandha to improve energy and desire. We also use L-Citrulline Malate to
            help with blood flow and Mucuna Pruriens to improve mood and motivation.</p>

        </div>
        <div class="faq-product-1">
          <div class="heading-faqs-product">
            <h1> Are these ingredients safe</h1>
            <div class="icon-flip"><img src="./assets/images/x-vector.svg" alt=""></div>
          </div>
          <p id="para-faq-p">Yes, we use a blend of natural ingredients that have been used for a long time. These
            ingredients are known to support health and well-being. However, if you have any health concerns, it’s
            always best to talk to a doctor before trying a new product.</p>


        </div>
        <div class="faq-product-1">
          <div class="heading-faqs-product">
            <h1>Are there any stimulants in your chocolates</h1>
            <div class="icon-flip"><img src="./assets/images/x-vector.svg" alt=""></div>
          </div>
          <p id="para-faq-p">We use natural, plant-based ingredients like Horny Goat Weed and Damiana Extract that are
            known to help with blood flow and libido. These are not strong stimulants like caffeine, but they are
            designed to support your body's natural desires.</p>


        </div>
      </div>
    </div>
  </div>
  <div class="splide">
    <div class="splide__track splide__track-3 ">
      <ul class="splide__list">
        <li class="splide__slide"> No side effects. Just pleasure.</li>

        <li class="splide__slide"><img src="./assets/images/marq-2.png" alt=""></li>
        <li class="splide__slide">Taste her addiction</li>

        <li class="splide__slide"><img src="./assets/images/marq-3.png" alt=""></li>
        <li class="splide__slide">Stay hard after the nut</li>

        <li class="splide__slide"><img src="./assets/images/marq-1.png" alt=""></li>
      </ul>
    </div>
  </div>
  <div class="heading-review-main">NATURE'S NAUGHTIEST<br>RECIPE</div>
 <div class="ingredients-section">
    <div class="upper-section-ing">
      <div class="right-side-circle-ing">
        <div class="circle-ing">
          <img src="./assets/images/Husband Ingredients Ring.png" alt="">
        </div>
        <div class="center-choco">
          <img src="./assets/images/Hubby-Chocolate-Mockup.png" alt="">
        </div>
      </div>
      <div class="left-side-content-ing">
        <div class="right-side-content-ab">
          <h1 class="ing-h">For Hubby </h1>
          <span class="warning">⚠️ Playful Disclaimer</span>
          <p class="ing-p">🔥 Get ready for energy, focus, and stamina that keep the night unforgettable and turn her into your lover. Here’s how these carefully chosen ingredients work their magic for him:</p>
          <ul>
            <li>🍆 Firm strength that doesn’t quit</li>
            <li>🦍 Stamina that keeps going longer than expected.</li>
            <li>💦 More control, more timing, more satisfaction.</li>
            <li>😈 Power and rhythm that raise the intensity.</li>
            <li>🧠 Focused mind, energized body.</li>
            <li>🧠 Confidence boost — no hesitations, just sparks.</li>


          </ul>
          <div class="cta" id="product-page">Shop now and get dirty 💦 </div>
        </div>
      </div>
    </div>
    <div class="upper-section-ing">
      <div class="right-side-circle-ing">
        <div class="circle-ing">
          <img src="./assets/images/Wife Ingredients Ring.png" alt="">
        </div>
        <div class="center-choco">
          <img src="./assets/images/Wife-Chocolate-Mockup.png" alt="">
        </div>
      </div>
      <div class="left-side-content-ing">
        <div class="right-side-content-ab">
          <h1 class="ing-h">For Wifey</h1>
          <span class="warning">⚠️Playful Warning</span>
          <p class="ing-p">🔥 🔥 May cause irresistible desire, heightened sensations, and nights you’ll both remember. Here’s how these ingredients work their magic for her</p>
          <ul>
            <li>🌊 Deep, lasting intimacy and natural flow.</li>
            <li>⚡ Heightened sensitivity in all the right places.</li>
            <li>🔁 Intensified pleasure that lingers longer..</li>
            <li>🔥 Quicker arousal, stronger connection</li>
            <li>🍑 Tighter, hungrier, and louder.</li>
            <li>😩 Increased craving for closeness.</li>
            <li>🧠 Melts away stress, leaving only pleasure..
            </li>

          </ul>
          <div class="cta" id="product-page">Shop now and get dirty 💦 </div>
        </div>
      </div>
    </div>
  </div>

  <div class="splide">
    <div class="splide__track splide__track-3 ">
      <ul class="splide__list">
        <li class="splide__slide"> No side effects. Just side sluts.</li>

        <li class="splide__slide"><img src="./assets/images/marq-2.png" alt=""></li>
        <li class="splide__slide">Taste her addiction</li>

        <li class="splide__slide"><img src="./assets/images/marq-3.png" alt=""></li>
        <li class="splide__slide">Stay hard after the nut</li>

        <li class="splide__slide"><img src="./assets/images/marq-1.png" alt=""></li>
      </ul>
    </div>
  </div>
  <div class="halal-section">
    <div class="box-content">
      <div class="icon"><img src="https://chocolatex.in/cdn/shop/files/Group_129_138x.png?v=1728386781" alt=""></div>
      <h2>Indulge in Gameplay</h2>
      <p>Enjoy a quick, hot, naughty card game to break the ice.</p>
    </div>
    <div class="box-content">
      <div class="icon"><img src="https://chocolatex.in/cdn/shop/files/disguise_1_138x.png?v=1728386795" alt=""></div>
      <h2>Discreet Delivery </h2>
      <p>Psst, even your delivery guy won’t know. </p>
    </div>
    <div class="box-content">
      <div class="icon"><img src="https://chocolatex.in/cdn/shop/files/Group_81_138x.png?v=1728386798" alt=""> </div>
      <h2>100% Natural</h2>
      <p>We’re darn serious about what we put into our chocolates, no nasties.</p>

    </div>
  </div>
  <div class="image-for-delivery">
    <img class="des-d" src="./assets/images/discreet_1_2000x.webp" alt="">
    <img class="mob-d" src="./assets/images/Group_27373_100x.jpg" alt="">
  </div>
  <div class="splide">
    <div class="splide__track splide__track-2 ">
      <ul class="splide__list">
        <li class="splide__slide"> One bite = 3 orgasms</li>

        <li class="splide__slide"><img src="./assets/images/marq-2.png" alt=""></li>
        <li class="splide__slide">She can’t stop shaking</li>

        <li class="splide__slide"><img src="./assets/images/marq-3.png" alt=""></li>
        <li class="splide__slide">Pre-cum in seconds</li>

        <li class="splide__slide"><img src="./assets/images/marq-1.png" alt=""></li>
      </ul>
    </div>
  </div>
  <div class="heading-review-main">Not Just Reviews… <br> These Are Afterglows.</div>
  <div class="review-section-container">
    <div class="width-container" id="cardTrack">
      <div class="card-review">
        <div class="star"><img src="./assets/images/Frame 42.svg" alt=""></div>
        <div class="heading-name">Fatima R</div>
        <div class="client-name">CLIENT</div>
        <p>We've been married for over 15 years, and lately, things have just felt a bit… routine. I saw an ad for this
          and thought, why not? We had a quiet evening at home and shared a box of the Dark Desire. It felt like we were
          back on our first dates, talking and connecting in a way we haven't in years. Thank you for helping us find
          our spark again.</p>
      </div>
      <div class="card-review">
        <div class="star"><img src="./assets/images/Frame 42.svg" alt=""></div>
        <div class="heading-name">Ahmed S.</div>
        <div class="client-name">CLIENT</div>
        <p>To be honest, I'm not a big chocolate guy, but my wife insisted we try this. I'm glad she did. We had the
          Dark Desire. It slowed us down, made us focus on each other, and led to a truly romantic night. Highly
          recommend it to any couple looking to add a little something extra to their intimate routine</p>
      </div>
      <div class="card-review">
        <div class="star"><img src="./assets/images/Frame 42.svg" alt=""></div>
        <div class="heading-name">Aisha J.</div>
        <div class="client-name">CLIENT</div>
        <p>I was skeptical at first, but after a friend recommended it, I ordered a box for my husband and me. The
          StrawBae is divine! We made it a point to share them after the kids were in bed. It's become our new little
          ritual, our 'us time.' This has been a game-changer for us.</p>
      </div>
      <div class="card-review">
        <div class="star"><img src="./assets/images/Frame 42.svg" alt=""></div>
        <div class="heading-name"> Zahra H</div>
        <div class="client-name">CLIENT</div>
        <p>My husband travels a lot for work, and it's always hard to get back into sync when he's home. I bought a box
          of the VanilLust chocolates to have waiting for him when he got back. It felt special and thoughtful, and it
          definitely set the mood for a beautiful evening. We’re already planning to make this a regular thing!</p>
      </div>
    </div>
    <div class="pagination-btn">
      <div class="right"><img src="./assets/images/left.png" alt=""></div>
      <div class="left"><img src="./assets/images/right.png" alt=""></div>
    </div>
  </div>
  <div class="splide">
    <div class="splide__track splide__track-3 ">
      <ul class="splide__list">
        <li class="splide__slide"> No side effects. Just pleasure</li>

        <li class="splide__slide"><img src="./assets/images/marq-2.png" alt=""></li>
        <li class="splide__slide">Taste her addiction</li>

        <li class="splide__slide"><img src="./assets/images/marq-3.png" alt=""></li>
        <li class="splide__slide">Stay hard after the nut</li>

        <li class="splide__slide"><img src="./assets/images/marq-1.png" alt=""></li>
      </ul>
    </div>
  </div>
  <div class="faqs-section-container">
    <div class="faq-headings">
      🍫 Frequently Asked Questions (FAQs)

    </div>
    <div class="faq-toggle-container">


      <div class="faq">
        <div class="bar-f">
          <h1>When should we take JWW Chocolates?</h1>
          <div class="toggle-btn-faq"><img src="./assets/images/x-vector.svg" alt=""></div>
        </div>
        <div class="faq-content">
          <p>Right before things get hot. 🔥
            Take 1 piece each (Him & Her) about 30–45 minutes before intimacy — preferably on a light stomach, no heavy
            food or alcohol. Whether it’s a planned night of passion or a spontaneous session, this is your pre-game
            ritual for unforgettable sex.</p>
        </div>
      </div>
      <div class="faq">
        <div class="bar-f">
          <h1>Is this safe for regular use?</h1>
          <div class="toggle-btn-faq"><img src="./assets/images/x-vector.svg" alt=""></div>
        </div>
        <div class="faq-content">
          <p>Yes. We use only 100% natural and herbal ingredients, without any artificial stimulants, hormones, or
            chemicals. Safe for both men and women — no side effects, no crash.</p>
        </div>
      </div>
      <div class="faq">
        <div class="bar-f">
          <h1>How long before it starts working?</h1>
          <div class="toggle-btn-faq"><img src="./assets/images/x-vector.svg" alt=""></div>
        </div>
        <div class="faq-content">
          <p>Usually within 30 to 45 minutes after taking it on a light stomach. Effects can last for several hours —
            and some say the afterglow lasts even longer. 😉</p>
        </div>
      </div>
      <div class="faq">
        <div class="bar-f">
          <h1>Will it work for both partners?</h1>
          <div class="toggle-btn-faq"><img src="./assets/images/x-vector.svg" alt=""></div>
        </div>
        <div class="faq-content">
          <p>Yes — we’ve created Hubby & Wifey tabs, tailored specifically to the male and female body. The ingredients
            are chosen to enhance blood flow, arousal, lubrication, stamina, satisfaction and many things for both.</p>
        </div>
      </div>
      <div class="faq">
        <div class="bar-f">
          <h1>What makes it better than vaigra or supplements?</h1>
          <div class="toggle-btn-faq"><img src="./assets/images/x-vector.svg" alt=""></div>
        </div>
        <div class="faq-content">
          <p>1. Faster & Stronger Than Viagra** <br>
            2. ✅ Onset in 30-60mins <br>

            3. Zero Side Effects <br>
            4. ❌ No headaches, blue vision, or heart strain (Viagra blocks PDE5 unnaturally)
            <br>
            5. ❌ No dependency(adaptogens protect receptors)
          </p>
        </div>
      </div>
      <div class="faq">
        <div class="bar-f">
          <h1>Does it taste like herbs or medicine?</h1>
          <div class="toggle-btn-faq"><img src="./assets/images/x-vector.svg" alt=""></div>
        </div>
        <div class="faq-content">
          <p>Not at all. We use premium chocolate — dark, white, and strawberry . You’ll never taste the herbs… just
            pleasure. 🍫 </p>
        </div>
      </div>

      <div class="faq">
        <div class="bar-f">
          <h1>Who should not take JWW chocolates?</h1>
          <div class="toggle-btn-faq"><img src="./assets/images/x-vector.svg" alt=""></div>
        </div>
        <div class="faq-content">
          <p>JWW chocolates is not intended for use by singles (who are not legally married) and children under the age
            of 18. If you are pregnant, nursing, taking any medication, or have any medical condition, consult your
            doctor before use.</p>
        </div>
      </div>

    </div>
  </div>
  <div class="splide">
    <div class="splide__track splide__track-3 ">
      <ul class="splide__list">
        <li class="splide__slide">So strong, it’s sinful</li>

        <li class="splide__slide"><img src="./assets/images/marq-2.png" alt=""></li>
        <li class="splide__slide"> For couples who can’t behave</li>

        <li class="splide__slide"><img src="./assets/images/marq-3.png" alt=""></li>
        <li class="splide__slide"> Stay hard after the nut</li>

        <li class="splide__slide"><img src="./assets/images/marq-1.png" alt=""></li>
      </ul>
    </div>
  </div>
  <footer>
    <div class="section-main-footer">
      <div class="side-left-logo">
        <div class="logo-footer">
          <img src="./assets/images/footer-logo.png" alt="">
        </div>
        <div class="para-footer">
          Pakistan's 1st Premium Herbal Seggs Chocolate Brand 🍫<br>
          <p> Herbal, Fast & Intense: Made for unstoppable cravings </p>
          💦
        </div>
        <div class="cta-footer">
          <div class="cta" id="product-page">Get dirty now</div>
        </div>
      </div>
      <div class="menu-links-footer">
        <ul>
          <li>
            <h1>LINKS</h1>
          </li>
          <li><a href="./index.html">HOME</a></li>
          <li><a href="./About.html">ABOUT</a></li>
          <li><a href="./contact.html">CONTACT</a></li>
        </ul>

        <ul>
          <li>
            <h1>SOCIAL MEDIA</h1>
          </li>
          <li><a href="https://www.instagram.com/jabweweds/" target="_blank">INSTAGRAM</a></li>
          <li><a href="https://www.facebook.com/share/1BHEh4A6wU/" target="_blank">FACEBOOK</a></li>
          <li><a href="https://x.com/JabWeWeds?t=Icz5FqbLT_86aVEqnzplqQ&s=09" target="_blank">X</a></li>
          <li><a href="https://wa.me/9203390117465" target="_blank">WHATSAPP</a></li>
        </ul>
      </div>

    </div>
    <div class="arrow-top-sect">
      <img src="./assets/images/arrow-slider.png" alt="">
    </div>
    <div class="privacy-policy">
      <p>all right reserved jabweweds</p>
    </div>
    <div class="splide">
      <div class="splide__track splide__track-1  ">
        <ul class="splide__list ">
          <li class="splide__slide slide-footer">Better than lube</li>

          <li class="splide__slide"><img src="./assets/images/marq-2.png" alt=""></li>
          <li class="splide__slide  slide-footer">Pre-cum in seconds</li>

          <li class="splide__slide"><img src="./assets/images/marq-3.png" alt=""></li>
          <li class="splide__slide  slide-footer">4+hrs of pounding</li>

          <li class="splide__slide"><img src="./assets/images/marq-1.png" alt=""></li>
        </ul>
      </div>
    </div>
  </footer>

  <script>
    const CONFIG = {

      // BACKEND_URL: 'http://localhost:8000'
      BACKEND_URL: 'https://jww-backend-main-production.up.railway.app'
    };
  </script>
  <script>
    // ====================
    // FIXED PRODUCT PAGE SCRIPT (Replace your existing product page script)
    // ====================

    // API Configuration
    const API_BASE_URL = CONFIG.BACKEND_URL;

    // Global state
    let productsData = [];
    let currentProduct = {
      id: null,
      flavor: null,
      size: null,
      sizePrice: 0,
      boxCount: 1,
      totalPrice: 0
    };

    // Get URL parameters function
    function getURLParameters() {
      const urlParams = new URLSearchParams(window.location.search);
      return {
        productId: urlParams.get('productId'),
        productSlug: urlParams.get('product'),
        productName: urlParams.get('name')
      };
    }

    // UPDATED: Fetch products with URL parameter handling
    async function fetchProducts() {
      try {
        const response = await fetch(`${API_BASE_URL}/GetAllProducts`);
        const data = await response.json();

        if (data.success) {
          productsData = data.products;

          // Check URL parameters BEFORE initializing default product
          const urlParams = getURLParameters();
          // console.log('URL Parameters:', urlParams); // Debug log

          initializeProductPage();

          // Handle URL parameters for specific product selection
          if (urlParams.productId || urlParams.productSlug || urlParams.productName) {
            selectProductFromURL(urlParams);
          } else {
            // Only select default if no URL parameters
            selectDefaultProduct();
          }

          // Dispatch custom event for other scripts to listen to
          setTimeout(() => {
            document.dispatchEvent(new CustomEvent('productDataLoaded', {
              detail: { products: productsData }
            }));
          }, 100);
        } else {
          throw new Error(data.message || 'Failed to fetch products');
        }
      } catch (error) {
        console.error('Error fetching products:', error);
        document.getElementById('product-name').textContent = 'Error loading products';
        document.getElementById('product-description').textContent = error.message;
      }
    }

    // UPDATED: Function to select product based on URL parameters
    function selectProductFromURL(urlParams) {
      let selectedProduct = null;

      // console.log('Searching for product with params:', urlParams); // Debug log
      // console.log('Available products:', productsData.map(p => ({ id: p._id, title: p.title }))); // Debug log

      // Try to find by product ID first (most accurate)
      if (urlParams.productId) {
        selectedProduct = productsData.find(p => p._id === urlParams.productId);
        // console.log('Found by ID:', selectedProduct); // Debug log
      }

      // If not found by ID, try by slug
      if (!selectedProduct && urlParams.productSlug) {
        selectedProduct = productsData.find(p => {
          const slug = p.title.toLowerCase().replace(/\s+/g, '-');
          return slug === urlParams.productSlug;
        });
        // console.log('Found by slug:', selectedProduct); // Debug log
      }

      // If still not found, try by name (case-insensitive)
      if (!selectedProduct && urlParams.productName) {
        selectedProduct = productsData.find(p =>
          p.title.toLowerCase().includes(urlParams.productName.toLowerCase().replace(/\s+/g, ' '))
        );
        // console.log('Found by name:', selectedProduct); // Debug log
      }

      if (selectedProduct) {
        // Update active state in category buttons after a short delay
        setTimeout(() => {
          updateActiveCategory(selectedProduct._id);
          selectProduct(selectedProduct);
        }, 300);
      } else {
        console.warn('Product not found for URL params:', urlParams);
        // Fallback to default product
        selectDefaultProduct();
      }
    }

    // Function to update active category button
    function updateActiveCategory(productId) {
      const categoryButtons = document.querySelectorAll('.btn-s');
      categoryButtons.forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.productId === productId) {
          btn.classList.add('active');
        }
      });
    }

    // Initialize the product page with API data
    function initializeProductPage() {
      if (productsData.length === 0) return;
      createCategoryButtons();
      setupEventListeners();
    }

    // Create category buttons from API data
    function createCategoryButtons() {
      const categoryContainer = document.getElementById('category-buttons');

      categoryContainer.innerHTML = productsData.map((product, index) => {
        const categoryClass = getCategoryClass(product.category);
        // ALWAYS use cover image (first image) for category button
        const coverImageUrl = getCoverImageUrl(product);

        return `
            <div class="btn-s" data-product-id="${product._id}" data-index="${index}">
                <div class="choco-img">
                    <img src="${coverImageUrl}" alt="${product.title}">
                </div>
                <div class="bg-btn ${categoryClass}"></div>
                <div class="text-btn">${product.title.toUpperCase()}</div>
            </div>
        `;
      }).join('');
    } function getCategoryClass(category) {
      switch (category.toLowerCase()) {
        case 'strawberry flavour':
          return 'strwa-bg';
        case 'dark desire':
          return 'choco-bg';
        case 'vanilla lust':
          return 'vanilla-bg';
        default:
          return 'choco-bg';
      }
    }
    function getCoverImageUrl(product) {
      if (!product.images || product.images.length === 0) {
        return './assets/images/ABout-pic.png';
      }

      // Find cover image
      const coverImage = product.images.find(img => img.isCover);
      return coverImage ? getImageUrl(coverImage) : getImageUrl(product.images[0]);
    }

    // Get image URL with fallback
    function getImageUrl(image) {
      if (!image) return './assets/images/ABout-pic.png';
      const imageUrl = typeof image === 'string' ? image : image.url;
      return imageUrl ? `${API_BASE_URL}${imageUrl}` : './assets/images/ABout-pic.png';
    }

    // Select default product (first one) - only if no URL params
    function selectDefaultProduct() {
      if (productsData.length > 0) {
        // Set first product as active
        const firstButton = document.querySelector('.btn-s[data-index="0"]');
        if (firstButton) {
          firstButton.classList.add('active');
        }
        selectProduct(productsData[0]);
      }
    }

    // Select a specific product
    function selectProduct(product) {
      currentProduct.id = product._id;
      currentProduct.flavor = product.title.toLowerCase();

      // Update product name and description
      document.getElementById('product-name').textContent = product.title;
      document.getElementById('product-description').textContent = product.description;

      // Create size buttons from product data
      createSizeButtons(product.sizeVariants);

      // Always use the same slider images regardless of size
      updateProductImages(product.images);

      // Update other components...
      updateMenuProducts();

      // Setup bottom image click functionality
      setTimeout(() => {
        setupBottomImageClicks();
      }, 200);

      // Reset the flag so product-cmp.js can reinitialize
      window.productSliderInitialized = false;

      // Dispatch event after DOM updates
      setTimeout(() => {
        document.dispatchEvent(new CustomEvent('productDataLoaded', {
          detail: {
            products: productsData,
            currentProduct: product
          }
        }));
      }, 300);
    } function updateProductImagesWithSizeFilter(images, selectedSize) {
      const slider = document.getElementById('slider-product-ch');

      if (!images || images.length === 0) {
        slider.innerHTML = '<img src="./assets/images/ABout-pic.png" alt="Default product image" class="product-slider-img" style="opacity: 1;">';
        return;
      }

      let sliderImages = [];

      if (selectedSize === 'small') {
        // For small size: show small size image and other non-cover images
        const smallImage = images.find(img => img.isSmallSizeImage);
        if (smallImage) {
          sliderImages = [smallImage, ...images.filter(img => !img.isCover && !img.isSmallSizeImage)];
        } else {
          sliderImages = images.filter(img => !img.isCover);
        }
      } else {
        // For large size: show cover image and other non-small images
        const coverImage = images.find(img => img.isCover);
        if (coverImage) {
          sliderImages = [coverImage, ...images.filter(img => !img.isCover && !img.isSmallSizeImage)];
        } else {
          sliderImages = images.filter(img => !img.isSmallSizeImage);
        }
      }

      if (sliderImages.length > 0) {
        slider.innerHTML = sliderImages.map((image, index) =>
          `<img src="${getImageUrl(image)}" alt="Product image" class="product-slider-img" style="opacity: ${index === 0 ? 1 : 0};">`
        ).join('');
      } else {
        slider.innerHTML = '<img src="./assets/images/ABout-pic.png" alt="Default product image" class="product-slider-img" style="opacity: 1;">';
      }

      // Update the bottom three images
      updateBottomImages(images);

      // Initialize slider after images are loaded
      initializeProductSlider();
    }

    // Update product images in the slider - EXCLUDING COVER IMAGE
    function updateProductImages(images) {
      const slider = document.getElementById('slider-product-ch');

      if (images && images.length > 2) {
        // Use only middle images (skip first cover image and last small variant image)
        // Images at indices 1, 2, 3, 4, 5, 6 (total 6 images)
        const sliderImages = images.slice(1, -1); // This excludes first and last image

        if (sliderImages.length > 0) {
          slider.innerHTML = sliderImages.map((image, index) =>
            `<img src="${getImageUrl(image)}" alt="Product image" class="product-slider-img" style="opacity: ${index === 0 ? 1 : 0};">`
          ).join('');
        } else {
          // Fallback if no middle images
          slider.innerHTML = '<img src="./assets/images/ABout-pic.png" alt="Default product image" class="product-slider-img" style="opacity: 1;">';
        }
      } else {
        // Fallback for products with few images
        slider.innerHTML = '<img src="./assets/images/ABout-pic.png" alt="Default product image" class="product-slider-img" style="opacity: 1;">';
      }

      // Update the bottom three images using middle images
      updateBottomImages(images);

      // Initialize slider after images are loaded
      initializeProductSlider();
    }
    function updateBottomImages(images) {
      const middleImages = document.querySelectorAll('.middle-picture-p .img-p-1 img');
      const lastImage = document.querySelector('.upper-picture-p.last-p img');

      if (images && images.length > 2) {
        const sliderImages = images.slice(1, -1); // Same middle images as slider

        if (middleImages.length >= 2 && sliderImages.length >= 2) {
          middleImages[0].src = getImageUrl(sliderImages[0]); // Second overall image (index 1)
          middleImages[0].alt = "Product image";

          if (sliderImages.length >= 2) {
            middleImages[1].src = getImageUrl(sliderImages[1]); // Third overall image (index 2)
            middleImages[1].alt = "Product image";
          }
        }

        if (lastImage && sliderImages.length >= 3) {
          lastImage.src = getImageUrl(sliderImages[2]); // Fourth overall image (index 3)
          lastImage.alt = "Product image";
        }
      } else {
        // Fallback for products with few images
        if (middleImages.length >= 2) {
          middleImages[0].src = './assets/images/ABout-pic.png';
          middleImages[1].src = './assets/images/ABout-pic.png';
        }
        if (lastImage) {
          lastImage.src = './assets/images/ABout-pic.png';
        }
      }
    }
    function initializeProductSlider() {
      // Clear any existing intervals first
      if (window.sliderChInterval) {
        clearInterval(window.sliderChInterval);
        window.sliderChInterval = null;
      }

      // Reset the initialization flag to allow re-initialization
      window.productSliderInitialized = false;

      const sliderChImages = document.querySelectorAll("#slider-product-ch img");
      const sliderChPrevBtn = document.querySelectorAll(".btns-next-p-1")[0];
      const sliderChNextBtn = document.querySelectorAll(".btns-next-p-1")[1];

      if (sliderChImages.length === 0) {
        // console.log('No slider images found');
        return;
      }

      let sliderChCurrent = 0;

      function showImageCSS(index) {
        sliderChImages.forEach((img, i) => {
          img.style.opacity = i === index ? '1' : '0';
          img.style.transition = 'opacity 0.8s ease';
        });
      }

      function startAutoCSS() {
        if (sliderChImages.length <= 1) return;
        window.sliderChInterval = setInterval(() => {
          sliderChCurrent = (sliderChCurrent + 1) % sliderChImages.length;
          showImageCSS(sliderChCurrent);
        }, 3000);
      }

      function stopAutoCSS() {
        if (window.sliderChInterval) {
          clearInterval(window.sliderChInterval);
          window.sliderChInterval = null;
        }
      }

      // Initialize display
      showImageCSS(0);

      // Remove existing event listeners by cloning and replacing buttons
      if (sliderChNextBtn) {
        const newNextBtn = sliderChNextBtn.cloneNode(true);
        sliderChNextBtn.parentNode.replaceChild(newNextBtn, sliderChNextBtn);

        newNextBtn.addEventListener("click", () => {
          stopAutoCSS();
          sliderChCurrent = (sliderChCurrent + 1) % sliderChImages.length;
          showImageCSS(sliderChCurrent);
          startAutoCSS();
        });
      }

      if (sliderChPrevBtn) {
        const newPrevBtn = sliderChPrevBtn.cloneNode(true);
        sliderChPrevBtn.parentNode.replaceChild(newPrevBtn, sliderChPrevBtn);

        newPrevBtn.addEventListener("click", () => {
          stopAutoCSS();
          sliderChCurrent = (sliderChCurrent - 1 + sliderChImages.length) % sliderChImages.length;
          showImageCSS(sliderChCurrent);
          startAutoCSS();
        });
      }

      startAutoCSS();
      window.productSliderInitialized = true;
    }
    // Create size buttons from API data
    function createSizeButtons(sizeVariants) {
      const sizeContainer = document.getElementById('size-buttons');

      if (sizeVariants && sizeVariants.length > 0) {
        sizeContainer.innerHTML = sizeVariants.map((variant, index) => {
          const isActive = index === 0 ? 'active' : '';
          const hasDiscount = variant.discountedPrice && variant.discountedPrice < variant.price;
          const discountClass = hasDiscount ? 'has-discount' : '';

          return `
                <div class="cta size-btn ${isActive} ${discountClass}" 
                     data-size="${variant.size.toLowerCase()}" 
                     data-price="${variant.price}"
                     data-discounted-price="${variant.discountedPrice || ''}"
                     data-has-discount="${hasDiscount}">
                    ${variant.size}
                </div>
            `;
        }).join('');

        // Set initial current product values
        const firstVariant = sizeVariants[0];
        currentProduct.size = firstVariant.size.toLowerCase();
        currentProduct.sizePrice = firstVariant.discountedPrice || firstVariant.price;
        currentProduct.originalPrice = firstVariant.price;
        currentProduct.hasDiscount = firstVariant.discountedPrice && firstVariant.discountedPrice < firstVariant.price;

        createBoxSelection();
        // Remove: updateSizeSpecificImages() call
      } else {
        sizeContainer.innerHTML = '<p>No sizes available</p>';
      }
    }
    function updateSizeSpecificImages(selectedSize) {
      const currentProductData = productsData.find(p => p._id === currentProduct.id);
      if (!currentProductData || !currentProductData.images) return;

      const images = currentProductData.images;

      // Update ONLY the main slider image based on selected size
      let mainImageUrl;
      if (selectedSize === 'small') {
        // Find small size image (isSmallSizeImage: true) or use last image
        const smallImage = images.find(img => img.isSmallSizeImage) || images[images.length - 1];
        mainImageUrl = getImageUrl(smallImage);
      } else {
        // Use cover image or first image for large size
        const coverImage = images.find(img => img.isCover) || images[0];
        mainImageUrl = getImageUrl(coverImage);
      }

      // Update ONLY the main product image in slider - NOT the category button
      const mainProductImg = document.querySelector('#slider-product-ch img');
      if (mainProductImg) {
        mainProductImg.src = mainImageUrl;
      }

      // DO NOT update category button image - it should remain constant
      // The category button should always show the cover image

      // Update all other display images (this rebuilds the slider with proper images)
      updateProductImages(images);
    }   // Create box selection based on current size price
    function createBoxSelection() {
      const boxContainer = document.getElementById('box-selection');
      const hasDiscount = currentProduct.hasDiscount;
      const price = currentProduct.sizePrice; // This is already the final price (discounted if available)
      const originalPrice = currentProduct.originalPrice;

      boxContainer.innerHTML = [1, 2, 3].map((count, index) => {
        const isActive = index === 0 ? 'active' : '';
        const totalPrice = price * count;
        const totalOriginalPrice = originalPrice * count;

        let priceDisplay;
        if (hasDiscount) {
          priceDisplay = `
                <div class="price-container">
                    <span class="original-price">PKR: ${totalOriginalPrice}</span>
                    <span class="discounted-price">PKR: ${totalPrice}</span>
                    <span class="discount-badge">${Math.round((1 - price / originalPrice) * 100)}% OFF</span>
                </div>
            `;
        } else {
          priceDisplay = `<p class="box-price">PKR: ${totalPrice}</p>`;
        }

        return `
            <div class="p-box-1 ${isActive}" data-box="${count}">
                <div class="heading-1-box">${count} BOX</div>
                <div class="lower-price-tg">
                    <p>${count} Chocolate${count > 1 ? 's' : ''}</p>
                    ${priceDisplay}
                </div>
            </div>
        `;
      }).join('');

      currentProduct.boxCount = 1;
      updatePricing();
    }
    // Update menu products
    function updateMenuProducts() {
      const menuContainer = document.getElementById('menu-products');
      if (!menuContainer) {
        console.warn('menu-products element not found');
        return;
      }

      menuContainer.innerHTML = `
    <div class="grid-box-container">
      ${productsData.map(product => `
        <div class="box" data-product-id="${product._id}">
          <div class="elents"><img src="./assets/images/el-1.png" alt=""></div>
          <div class="elents"><img src="./assets/images/marq-2.png" alt=""></div>
          <div class="elents"><img src="./assets/images/el-2.png" alt=""></div>
          <div class="name-box">${product.title.toUpperCase()}</div>
          <div class="choco-menu">
            <img src="${getImageUrl(product.images[0])}" alt="${product.title}">
          </div>
        </div>
      `).join('')}
    </div>
  `;

      menuContainer.style.display = 'block';
      const staticMenu = document.getElementById('static-menu');
      if (staticMenu) {
        staticMenu.style.display = 'none';
      }
    }

    // Setup event listeners
    function setupEventListeners() {
      document.addEventListener('click', (e) => {
        // Category button click
        if (e.target.closest('.btn-s')) {
          const button = e.target.closest('.btn-s');
          const productId = button.dataset.productId;

          document.querySelectorAll('.btn-s').forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');

          const product = productsData.find(p => p._id === productId);
          if (product) {
            selectProduct(product);
          }
        }

        // Size button click - UPDATED: No image switching
        if (e.target.classList.contains('cta') && e.target.closest('#size-buttons')) {
          document.querySelectorAll('#size-buttons .cta').forEach(btn => btn.classList.remove('active'));
          e.target.classList.add('active');

          const selectedSize = e.target.dataset.size;
          const price = parseInt(e.target.dataset.price);
          const discountedPrice = e.target.dataset.discountedPrice ? parseInt(e.target.dataset.discountedPrice) : null;
          const hasDiscount = e.target.dataset.hasDiscount === 'true';

          currentProduct.size = selectedSize;
          currentProduct.originalPrice = price;
          currentProduct.sizePrice = discountedPrice || price;
          currentProduct.hasDiscount = hasDiscount;

          // Remove all image switching logic - just update pricing
          createBoxSelection();
        }

        // Box selection click
        if (e.target.closest('.p-box-1')) {
          const button = e.target.closest('.p-box-1');
          document.querySelectorAll('.p-box-1').forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');

          currentProduct.boxCount = parseInt(button.dataset.box);
          updatePricing();
        }
      });

      // Other event listeners remain the same...
      document.getElementById('add-to-cart').addEventListener('click', addToCart);
      document.getElementById('open-cart').addEventListener('click', () => cartManager.openCart());
      document.getElementById('close-cart').addEventListener('click', () => cartManager.closeCart());

      const clearCartBtn = document.getElementById('clear-cart');
      if (clearCartBtn) {
        clearCartBtn.addEventListener('click', () => cartManager.clearCart());
      }
    }
    // Update pricing display
    function updatePricing() {
      const hasDiscount = currentProduct.hasDiscount;
      const totalPrice = currentProduct.sizePrice * currentProduct.boxCount;
      const totalOriginalPrice = currentProduct.originalPrice * currentProduct.boxCount;

      const totalPriceElement = document.getElementById('total-price');

      if (hasDiscount) {
        totalPriceElement.innerHTML = `
            <div class="price-container">
                <span class="original-price">PKR: ${totalOriginalPrice}</span>
                <span class="discounted-price">PKR: ${totalPrice}</span>
            </div>
        `;
      } else {
        totalPriceElement.textContent = `PKR: ${totalPrice}`;
      }

      currentProduct.totalPrice = totalPrice;
      document.getElementById('total-description').textContent = `${currentProduct.boxCount} Chocolate${currentProduct.boxCount > 1 ? 's' : ''}`;
    }
    // Add to cart function
    function addToCart() {
      if (!currentProduct.id) {
        alert('Please select a product');
        return;
      }

      const product = productsData.find(p => p._id === currentProduct.id);
      if (!product) {
        console.error('Product not found in productsData');
        return;
      }

      const productData = {
        productId: currentProduct.id,
        name: product.title,
        image: getCoverImageUrl(product), // Use cover image for cart
        flavor: currentProduct.flavor,
        size: currentProduct.size,
        sizePrice: currentProduct.sizePrice, // Final price (discounted if applicable)
        originalPrice: currentProduct.originalPrice, // Original price
        hasDiscount: currentProduct.hasDiscount,
        boxCount: currentProduct.boxCount,
        totalPrice: currentProduct.totalPrice
      };

      cartManager.addToCart(productData);
    }
    // Setup bottom image click functionality
    function setupBottomImageClicks() {
      const middleImages = document.querySelectorAll('.middle-picture-p .img-p-1');
      const lastImage = document.querySelector('.upper-picture-p.last-p');
      const mainSlider = document.getElementById('slider-product-ch');

      middleImages.forEach((imageContainer, index) => {
        imageContainer.style.cursor = 'pointer';
        imageContainer.addEventListener('click', () => {
          const sliderImages = mainSlider.querySelectorAll('img');
          if (sliderImages[index]) {
            sliderImages.forEach(img => img.style.opacity = '0');
            sliderImages[index].style.opacity = '1';
          }
        });
      });

      if (lastImage) {
        lastImage.style.cursor = 'pointer';
        lastImage.addEventListener('click', () => {
          const sliderImages = mainSlider.querySelectorAll('img');
          if (sliderImages[2]) { // Third image in slider
            sliderImages.forEach(img => img.style.opacity = '0');
            sliderImages[2].style.opacity = '1';
          }
        });
      }
    }
    // Initialize the application
    document.addEventListener('DOMContentLoaded', () => {
      // console.log('Product page DOM loaded');
      setTimeout(() => {
        fetchProducts();
      }, 200);
    });

    // Cleanup function
    function cleanupAnimations() {
      if (window.productSliderInterval) {
        clearInterval(window.productSliderInterval);
        window.productSliderInterval = null;
      }
      if (window.productSliderTL) {
        window.productSliderTL.kill();
        window.productSliderTL = null;
      }
      if (typeof gsap !== 'undefined') {
        gsap.killTweensOf("*");
      }
    }

    window.addEventListener('beforeunload', cleanupAnimations);
  </script>



  <script>
    const productPageLinks = document.querySelectorAll("#Navigate-to-checkout");

    productPageLinks.forEach(element => {
      element.style.cursor = "pointer"; // make it clickable
      element.addEventListener("click", () => {
        window.location.href = "./checkout.html";
      });
    });
    // ====================
    // 1. UPDATE HOME PAGE (index.html) - Add this to your existing script
    // ====================

    // Configuration


    // Product mapping for static menu items
    const PRODUCT_MAPPING = {
      'DARK DESIRE': 'dark-desire',
      'STRAWBAE': 'strawbae',
      'VANILLALUST': 'vanillalust',
      'BUNDLE': 'bundle'
    };

    // Function to handle menu product clicks
    function setupMenuProductNavigation() {
      // Handle static menu items
      const staticMenuBoxes = document.querySelectorAll('.slide-bar .box');

      staticMenuBoxes.forEach(box => {
        const productName = box.querySelector('.name-box')?.textContent;

        if (productName && PRODUCT_MAPPING[productName]) {
          // Remove existing product-page id to prevent conflicts
          box.removeAttribute('id');
          box.classList.add('menu-product-item');
          box.style.cursor = 'pointer';

          box.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();

            const productSlug = PRODUCT_MAPPING[productName];
            navigateToProduct(productSlug, productName);
          });
        }
      });
    }

    // Function to navigate to product page with parameters
    function navigateToProduct(productSlug, productName) {
      const url = `./product-page.html?product=${encodeURIComponent(productSlug)}&name=${encodeURIComponent(productName)}`;
      window.location.href = url;
    }

    // Function to update menu with dynamic products from API
    async function updateMenuWithAPIProducts() {
      try {
        const response = await fetch(`${CONFIG.BACKEND_URL}/GetAllProducts`);
        const data = await response.json();

        if (data.success && data.products) {
          updateDynamicMenu(data.products);
        }
      } catch (error) {
        console.error('Error fetching products for menu:', error);
        // Keep static menu as fallback
      }
    }

    // Function to create dynamic menu from API data
    function updateDynamicMenu(products) {
      const menuContainer = document.querySelector('.slide-bar .grid-box-container');
      if (!menuContainer) return;

      menuContainer.innerHTML = products.map(product => {
        const categoryClass = getCategoryClass(product.category);

        return `
            <div class="box ${categoryClass}" data-product-id="${product._id}">
                <div class="elents"><img src="./assets/images/el-1.png" alt=""></div>
                <div class="elents"><img src="./assets/images/marq-2.png" alt=""></div>
                <div class="elents"><img src="./assets/images/el-2.png" alt=""></div>
                <div class="name-box">${product.title.toUpperCase()}</div>
                <div class="choco-menu">
                    <img src="${getImageUrl(product.images[0])}" alt="${product.title}">
                </div>
            </div>
        `;
      }).join('');

      // Setup click handlers for dynamic menu
      setupDynamicMenuNavigation(products);
    }

    // Setup navigation for dynamically generated menu
    function setupDynamicMenuNavigation(products) {
      const menuBoxes = document.querySelectorAll('.slide-bar .box[data-product-id]');

      menuBoxes.forEach(box => {
        box.style.cursor = 'pointer';
        box.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();

          const productId = box.dataset.productId;
          const product = products.find(p => p._id === productId);

          if (product) {
            const productSlug = product.title.toLowerCase().replace(/\s+/g, '-');
            navigateToProductById(productId, product.title, productSlug);
          }
        });
      });
    }

    // Navigate to product by ID (for API products)
    function navigateToProductById(productId, productName, productSlug) {
      const url = `./product-page.html?productId=${encodeURIComponent(productId)}&name=${encodeURIComponent(productName)}&product=${encodeURIComponent(productSlug)}`;
      window.location.href = url;
    }

    // Helper functions
    function getCategoryClass(category) {
      switch (category?.toLowerCase()) {
        case 'strawberry flavour':
          return 'straw-bg';
        case 'dark desire':
          return ''; // default
        case 'vanilla lust':
          return 'vanilla-bg';
        default:
          return '';
      }
    }

    function getImageUrl(image) {
      if (!image) return './assets/images/ABout-pic.png';
      const imageUrl = typeof image === 'string' ? image : image.url;
      return imageUrl ? `${CONFIG.BACKEND_URL}${imageUrl}` : './assets/images/ABout-pic.png';
    }

    // ====================
    // 2. INITIALIZE HOME PAGE NAVIGATION
    // ====================
    document.addEventListener('DOMContentLoaded', () => {
      // Setup static menu first
      setupMenuProductNavigation();

      // Try to load dynamic menu from API
      updateMenuWithAPIProducts();

      // Keep existing product-page functionality for other elements
      const otherProductLinks = document.querySelectorAll("#product-page:not(.slide-bar .box)");
      otherProductLinks.forEach(element => {
        element.style.cursor = "pointer";
        element.addEventListener("click", () => {
          window.location.href = "./product-page.html";
        });
      });
    });

    // ====================
    // 3. PRODUCT PAGE UPDATES (product-page.html)
    // ====================

    // Add this function to your existing product page script
    function getURLParameters() {
      const urlParams = new URLSearchParams(window.location.search);
      return {
        productId: urlParams.get('productId'),
        productSlug: urlParams.get('product'),
        productName: urlParams.get('name')
      };
    }

    // Update your existing fetchProducts function to handle URL parameters
    async function fetchProductsWithSelection() {
      try {
        const response = await fetch(`${API_BASE_URL}/GetAllProducts`);
        const data = await response.json();

        if (data.success) {
          productsData = data.products;
          initializeProductPage();

          // Check URL parameters for specific product selection
          const urlParams = getURLParameters();
          if (urlParams.productId || urlParams.productSlug) {
            selectProductFromURL(urlParams);
          }

          // Dispatch event for other scripts
          setTimeout(() => {
            document.dispatchEvent(new CustomEvent('productDataLoaded', {
              detail: { products: productsData }
            }));
          }, 100);
        } else {
          throw new Error(data.message || 'Failed to fetch products');
        }
      } catch (error) {
        console.error('Error fetching products:', error);
        document.getElementById('product-name').textContent = 'Error loading products';
        document.getElementById('product-description').textContent = error.message;
      }
    }

    // Function to select product based on URL parameters
    function selectProductFromURL(urlParams) {
      let selectedProduct = null;

      if (urlParams.productId) {
        // Find by ID (most accurate)
        selectedProduct = productsData.find(p => p._id === urlParams.productId);
      } else if (urlParams.productSlug) {
        // Find by slug matching
        selectedProduct = productsData.find(p => {
          const slug = p.title.toLowerCase().replace(/\s+/g, '-');
          return slug === urlParams.productSlug;
        });
      }

      if (selectedProduct) {
        // Update active state in category buttons
        setTimeout(() => {
          updateActiveCategory(selectedProduct._id);
          selectProduct(selectedProduct);
        }, 200);
      } else if (urlParams.productName) {
        // Fallback: try to match by name
        selectedProduct = productsData.find(p =>
          p.title.toLowerCase() === urlParams.productName.toLowerCase()
        );

        if (selectedProduct) {
          setTimeout(() => {
            updateActiveCategory(selectedProduct._id);
            selectProduct(selectedProduct);
          }, 200);
        }
      }
    }

    // Function to update active category button
    function updateActiveCategory(productId) {
      const categoryButtons = document.querySelectorAll('.btn-s');
      categoryButtons.forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.productId === productId) {
          btn.classList.add('active');
        }
      });
    }

    // Update your DOMContentLoaded event in product page
    document.addEventListener('DOMContentLoaded', () => {
      console.log('Product page DOM loaded');

      // Wait for cart manager, then fetch products with selection
      setTimeout(() => {
        fetchProductsWithSelection(); // Use updated function
      }, 200);
    });

    // ====================
    // 4. OPTIONAL: Add breadcrumb navigation
    // ====================
    function addBreadcrumb(productName) {
      const breadcrumbHtml = `
        <div class="breadcrumb-nav" style="padding: 20px 0; font-size: 14px; color: #666;">
            <a href="./index.html" style="color: #667eea; text-decoration: none;">Home</a> 
            <span style="margin: 0 8px;">/</span> 
            <span>Products</span>
            <span style="margin: 0 8px;">/</span>
            <span style="color: #333; font-weight: 500;">${productName}</span>
        </div>
    `;

      const nav = document.querySelector('nav');
      if (nav) {
        nav.insertAdjacentHTML('afterend', breadcrumbHtml);
      }
    }

    // Call this in selectProduct function if you want breadcrumbs
    // addBreadcrumb(product.title);
  </script>

</body>
<!-- Load scripts in correct order - CART MANAGER MUST BE LOADED FIRST -->
<script type="module" src="./js/cart-manager.js"></script>
<script src="./js/product-page.js" type="module"></script>
<script>

  const faqs = document.querySelectorAll(".faq-product-1");

  faqs.forEach(faq => {
    const heading = faq.querySelector(".heading-faqs-product");

    heading.addEventListener("click", () => {
      const isActive = faq.classList.contains("active");

      // Close all first
      faqs.forEach(f => f.classList.remove("active"));

      // Re-open if clicked was inactive
      if (!isActive) {
        faq.classList.add("active");
      }
    });
  });

</script>
<script>
document.querySelectorAll(".product-card").forEach(card => {
  card.addEventListener("click", () => {
    // remove active from all (if you want only one active at a time)
    document.querySelectorAll(".p-box-1").forEach(c => c.classList.remove("active"));
    
    // add active to clicked one
    card.classList.add("active");
  });
});
</script>

</html>